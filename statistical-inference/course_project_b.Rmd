---
output:
  pdf_document: default
  html_document:
    keep_md: yes
---
<!--
    https://rstudio-pubs-static.s3.amazonaws.com/35364_334944a02fcf4792b232aacbfee2f6e6.html
    https://rpubs.com/roozbehdavari/33121
    http://www.r-bloggers.com/two-sample-students-t-test-1/
-->
# Assessing the ToothGrowth Dataset with R
#### Author: Danilo Mutti

```{r, echo = FALSE}
knitr::opts_chunk$set(fig.path = "course_project_b_figure/")
set.seed(1)
library(ggplot2, warn.conflicts = FALSE)
library(reshape2, warn.conflicts = FALSE)
```

The [ToothGrowth dataset](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/ToothGrowth.html) (TG) contains data about the effect of vitamin C on tooth growth in Guinea pigs. In this study, the response is the length of odontoblasts (teeth) in each of 60 distinct Guinea pigs, 10 for each combination of dose level of Vitamin C (0.5, 1, and 2 mg) and delivery method (orange juice or ascorbic acid).

The dataset contains a data frame with 60 observations on 3 variables.

|column index|column name| type      | description |
|------------|-----------|-----------|-------------|
| [,1]       | len	     | numeric	 |Tooth length |
| [,2]       | supp	     | factor    | Supplement type (VC or OJ).|
| [,3]       | dose      | numeric   | Dose in milligrams.|

We start by loading the dataset, followed by a basic exploration of how the data is structured.

```{r}
data(ToothGrowth)
str(ToothGrowth)
summary(ToothGrowth)
```

The following figure *seems to indicate* that orange juice (OJ) is more effective for lower/intermediate dose levels. When dose levels are higher, the effectiveness between OJ and Vitamin C (VC) *seems to be similar*, with OJ presenting more consistent results.

```{r}
coplot(len ~ dose | supp, data = ToothGrowth, panel = panel.smooth,
       xlab = "ToothGrowth data: length vs dose, given type of supplement")
```


## Data Processing

In this dataset, rows 1 to 10 correspond to the observations from Guinea pigs 1 to 10. The eleventh row contains another observation of Guinea pig number 1, and so on. In order to tidy this dataset, we are going to fit it into 6 columns and 10 rows. Each row corresponds to one specific Guinea pig, and each column represents a supplement (VC or OJ) and its associated dose (0.5, 1.0 or 2.0).

```{r}
ToothGrowth$guinea.pig <- rep(c(1:10), 6)
print(tidy <- dcast(ToothGrowth, guinea.pig ~ supp + dose, value.var = "len"))
```

## Data Analysis

In this section, we are going to perform several tests to compare tooth growth of Guinea pigs by supplement (OJ, VC) and dose (0.5, 1.0, and 2.0 milligrams).
For every comparation, we will consider the following hypotheses:

* H_0: Both supplements, for a given dosage, have the same effectiveness
* H_a: OJ is more effective than VC, for a given dosage.

### 0.5 milligrams - OJ versus VC

Before proceeding with the t-test, it is necessary to evaluate the sample variances of the two groups, using a Fisher's F-test to verify the homoskedasticity (homogeneity of variances).

```{r}
var.test(tidy$OJ_0.5, tidy$VC_0.5)
```

We obtained p-value greater than 0.05, then we can assume that the two variances are homogeneous.
Then we can call the function `t.test` for homogeneous variances (`var.equal = TRUE`) and independent samples (`paired = FALSE`)

```{r}
t.test(tidy$OJ_0.5, tidy$VC_0.5, paired = FALSE, var.equal = TRUE)
```

The value of t-computed (3.1697) is less than the tabulated t-value for 18 degrees of freedom (`r qt(0.975, 18)`). This confirms that we **can reject**, with a 95% confidence interval, the null hypothesis H_0 of equality of effectiveness, i.e., OJ is more effective than VC when the dosage is 0.5mg.

## Appendix

This section contains the environment in which this report was produced.

```{r}
sessionInfo()
```